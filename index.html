<!DOCTYPE html>
<html>
<head>
    <title>mn.vote</title>

    <!-- Google Analytics tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SYF2WH4DFV"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-SYF2WH4DFV');

        const urlParams = new URLSearchParams(window.location.search);
        const m = parseInt(urlParams.get('m')) || 0;  // Convert 'm' to an integer
        const v = urlParams.get('v');  // Leave 'v' as a string
        const t = parseInt(urlParams.get('t')) || 0;  // Convert 't' to an integer
        const who = urlParams.get('who');  // Leave 'who' as a string

        // Send an event to GA4 including custom dimensions for each parameter
        gtag('event', 'custom_page_view', {
            'm': m,
            'v': v,
            't': t,
            'who': who
        }, {
            'transport_type': 'beacon',  // ensures the event is sent immediately
            'event_callback': function() {
                setTimeout(function() {
                    window.location.href = "https://www.sos.mn.gov/elections-voting/";
                }, 3000);  // Increased delay to 3 seconds to ensure tracking
            }
        });
    </script>
</head>
<body>
    <!-- Simple Analytics script for privacy-first analytics (moved to body) -->
    <script 
        data-allow-params="t,m,v,who"
        data-collect-dnt="false"  <!-- Track all users, including those with Do Not Track enabled -->
        async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
    <noscript>
        <img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" />
    </noscript>   
</body>
</html>
